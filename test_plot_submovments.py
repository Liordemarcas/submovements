from plotSubmovements2D_file import plot_submovements_2D
import matplotlib.pyplot as plt
import numpy as np

# parameters = np.array([0.0733, 0.9494, -9.6477, 1.4371, 0.7533, 0.5781, -3.2429, 2.9841, 1.2081, 0.6425, 6.0247, -7.5022, 1.6303, 0.6804, 7.6570, 2.6737])
parameters = np.array(
    [[0.0732901823330051, 0.753332257401658, 1.20807205657632,  1.63027181524655],
    [0.949578793215849,   0.577808880654625, 0.642416229649353, 0.680421901622464],
    [-9.64911572424797,  -3.24104457152274,  6.02435540634948,  7.65754042751639],
    [1.43758625022674,    2.98360723859020, -7.50174516318254,  2.67369867193168]]
).reshape(4,4)

parameters = np.transpose(parameters)

t = np.array([0.0000, 0.0070, 0.0150, 0.0230, 0.0300, 0.0380, 0.0420, 0.0450, 0.0530, 0.0600, 0.0650, 0.0680, 0.0720, 0.0750, 0.0830, 0.0870, 0.0900, 0.0980, 0.1050, 0.1130, 0.1200, 0.1280, 0.1320, 0.1350, 0.1400, 0.1430, 0.1500, 0.1550, 0.1580, 0.1620, 0.1650, 0.1700, 0.1730, 0.1800, 0.1880, 0.1930, 0.1950, 0.2000, 0.2030, 0.2080, 0.2100, 0.2150, 0.2180, 0.2230, 0.2250, 0.2330, 0.2380, 0.2400, 0.2480, 0.2560, 0.2630, 0.2710, 0.2780, 0.2860, 0.2900, 0.2930, 0.2980, 0.3010, 0.3050, 0.3080, 0.3130, 0.3160, 0.3230, 0.3310, 0.3380, 0.3430, 0.3460, 0.3530, 0.3610, 0.3650, 0.3680, 0.3730, 0.3760, 0.3830, 0.3880, 0.3910, 0.3980, 0.4060, 0.4130, 0.4210, 0.4280, 0.4360, 0.4430, 0.4480, 0.4510, 0.4580, 0.4660, 0.4730, 0.4810, 0.4890, 0.4960, 0.5040, 0.5110, 0.5160, 0.5190, 0.5260, 0.5340, 0.5380, 0.5410, 0.5490, 0.5530, 0.5560, 0.5640, 0.5680, 0.5710, 0.5790, 0.5860, 0.5940, 0.6010, 0.6090, 0.6130, 0.6160, 0.6210, 0.6240, 0.6280, 0.6310, 0.6360, 0.6390, 0.6460, 0.6510, 0.6540, 0.6580, 0.6610, 0.6690, 0.6760, 0.6840, 0.6910, 0.6960, 0.6990, 0.7060, 0.7140, 0.7190, 0.7220, 0.7290, 0.7370, 0.7440, 0.7490, 0.7520, 0.7560, 0.7590, 0.7670, 0.7740, 0.7820, 0.7890, 0.7970, 0.8010, 0.8040, 0.8120, 0.8190, 0.8270, 0.8340, 0.8420, 0.8490, 0.8570, 0.8640, 0.8720, 0.8760, 0.8790, 0.8870, 0.8910, 0.8940, 0.8990, 0.9020, 0.9090, 0.9170, 0.9240, 0.9290, 0.9320, 0.9390, 0.9470, 0.9550, 0.9620, 0.9700, 0.9740, 0.9770, 0.9850, 0.9890, 0.9920, 1.0000, 1.0040, 1.0070, 1.0150, 1.0190, 1.0220, 1.0300, 1.0370, 1.0450, 1.0520, 1.0600, 1.0640, 1.0670, 1.0720, 1.0750, 1.0820, 1.0900, 1.0970, 1.1020, 1.1050, 1.1120, 1.1200, 1.1270, 1.1350, 1.1400, 1.1420, 1.1500, 1.1570, 1.1650, 1.1720, 1.1800, 1.1880, 1.1950, 1.2000, 1.2030, 1.2100, 1.2180, 1.2250, 1.2330, 1.2400, 1.2480, 1.2550, 1.2600, 1.2630, 1.2700, 1.2780, 1.2850, 1.2900, 1.2930, 1.2970, 1.3000, 1.3080, 1.3150, 1.3230, 1.3300, 1.3380, 1.3420, 1.3450, 1.3500, 1.3530, 1.3600, 1.3680, 1.3730, 1.3750, 1.3800, 1.3830, 1.3880, 1.3900, 1.3980, 1.4030, 1.4050, 1.4130, 1.4210, 1.4280, 1.4360, 1.4430, 1.4510, 1.4580, 1.4660, 1.4730, 1.4810, 1.4880, 1.4960, 1.5030, 1.5110, 1.5150, 1.5180, 1.5260, 1.5330, 1.5380, 1.5410, 1.5480, 1.5560, 1.5630, 1.5710, 1.5780, 1.5860, 1.5930, 1.6010, 1.6080, 1.6160, 1.6230, 1.6310, 1.6360, 1.6380, 1.6460, 1.6540, 1.6610, 1.6690, 1.6760, 1.6840, 1.6910, 1.6990, 1.7060, 1.7140, 1.7210, 1.7290, 1.7360, 1.7440, 1.7510, 1.7590, 1.7630, 1.7660, 1.7740, 1.7810, 1.7890, 1.7960, 1.8040, 1.8080, 1.8110, 1.8190, 1.8260, 1.8340, 1.8410, 1.8490, 1.8540, 1.8560, 1.8610, 1.8640, 1.8710, 1.8790, 1.8840, 1.8860, 1.8940, 1.9020, 1.9090, 1.9170, 1.9210, 1.9240, 1.9320, 1.9390, 1.9470, 1.9510, 1.9540, 1.9620, 1.9690, 1.9770, 1.9840, 1.9920, 1.9990, 2.0040, 2.0070, 2.0140, 2.0220, 2.0290, 2.0340, 2.0370, 2.0440, 2.0520, 2.0560, 2.0590, 2.0670, 2.0720, 2.0740, 2.0790, 2.0820, 2.0890, 2.0940, 2.0970, 2.1040, 2.1090, 2.1120, 2.1170, 2.1190, 2.1270, 2.1320, 2.1350, 2.1390, 2.1420, 2.1470, 2.1500, 2.1540, 2.1570, 2.1620, 2.1650, 2.1720, 2.1800, 2.1870, 2.1950, 2.2020, 2.2070, 2.2100, 2.2170, 2.2220, 2.2250, 2.2320, 2.2400, 2.2470, 2.2520, 2.2550, 2.2620, 2.2670, 2.2700, 2.2770, 2.2850, 2.2920, 2.2970, 2.3000, 2.3050, 2.3070,])
x0 = np.array([0])
y0 = np.array([0])

axs,fig = plot_submovements_2D(parameters,x0,y0,t=t)

true_v = np.array(
    [[0.000000, 1.992085, 2.009813, 2.020564, 2.020814, 2.006258, 1.973812, 1.924450, 1.861394, 1.784709, 1.692322, 1.585916, 1.471446, 1.355561, 1.242881, 1.135116, 1.034055, 0.942810, 0.861832, 0.787795, 0.716375, 0.643430, 0.565539, 0.481746, 0.393448, 0.302136, 0.207139, 0.104607, -0.009789, -0.138153, -0.281318, -0.439771, -0.613314, -0.802275, -1.010853, -1.247135, -1.518380, -1.828846, -2.181256, -2.577523, -3.018398, -3.503036, -4.028482, -4.589135, -5.176210, -5.778342, -6.383307, -6.977196, -7.542678, -8.061703, -8.520101, -8.910015, -9.231132, -9.491943, -9.709884, -9.907873, -10.108328, -10.329113, -10.582291, -10.873587, -11.201845, -11.558716, -11.929673, -12.298695, -12.655555, -12.999642, -13.336249, -13.669854, -14.003883, -14.346663, -14.712230, -15.113112, -15.553630, -16.028815, -16.528052, -17.038084, -17.540865, -18.013386, -18.434612, -18.791602, -19.080475, -19.305521, -19.478087, -19.614204, -19.728194, -19.823950, -19.893152, -19.922582, -19.901233, -19.822523, -19.684756, -19.492055, -19.255573, -18.993325, -18.725274, -18.465338, -18.220438, -17.998112, -17.808996, -17.660426, -17.553668, -17.486313, -17.451003, -17.434454, -17.419826, -17.385681, -17.306251, -17.159641, -16.936268, -16.642011, -16.297940, -15.935415, -15.586555, -15.276949, -15.024045, -14.837602, -14.720072, -14.667060, -14.668819, -14.714778, -14.797562, -14.909987, -15.038881, -15.163589, -15.260841, -15.313378, -15.316020, -15.275359, -15.203459, -15.109350, -14.997234, -14.872092, -14.740901, -14.606980, -14.468901, -14.327297, -14.189967, -14.068682, -13.971153, -13.895334, -13.829096, -13.755076, -13.658445, -13.532181, -13.377764, -13.203212, -13.017790, -12.825351, -12.623153, -12.406487, -12.172446, -11.920764, -11.653863, -11.376876, -11.097636, -10.827031, -10.578976, -10.367725, -10.203991, -10.094588, -10.043720, -10.051203, -10.109697, -10.204805, -10.319049, -10.438002, -10.553479, -10.660329, -10.750847, -10.814163, -10.841053, -10.828228, -10.779807, -10.706661, -10.622421, -10.538096, -10.460967, -10.396159, -10.346071, -10.310556, -10.288347, -10.276068, -10.267777, -10.255981, -10.230582, -10.179402, -10.093207, -9.970057, -9.816092, -9.643923, -9.468424, -9.300990, -9.145825, -9.000060, -8.857580, -8.714453, -8.571201, -8.429643, -8.288539, -8.143696, -7.991621, -7.831945, -7.666683, -7.496753, -7.318794, -7.126092, -6.911999, -6.671989, -6.404069, -6.108798, -5.789265, -5.450135, -5.094835, -4.723576, -4.335028, -3.928897, -3.506555, -3.070708, -2.625124, -2.174325, -1.722374, -1.270629, -0.817860, -0.363385, 0.091644, 0.546427, 1.003006, 1.465894, 1.939592, 2.426061, 2.922847, 3.424030, 3.923341, 4.416198, 4.901796, 5.385096, 5.874606, 6.377806, 6.898213, 7.435051, 7.989000, 8.568977, 9.189476, 9.863357, 10.598658, 11.397708, 12.255119, 13.158123, 14.091806, 15.038380, 15.970891, 16.856772, 17.666763, 18.377934, 18.973251, 19.441094, 19.774918, 19.973122, 20.038899, 19.980012, 19.808800, 19.542344, 19.202495, 18.816819, 18.417591, 18.031935, 17.672175, 17.342018, 17.046595, 16.787041, 16.551268, 16.318818, 16.071100, 15.794916, 15.482282, 15.130347, 14.741295, 14.321902, 13.882820, 13.438035, 13.004533, 12.602638, 12.255046, 11.979581, 11.781515, 11.656186, 11.596291, 11.594627, 11.643949, 11.736707, 11.864889, 12.020201, 12.194615, 12.381030, 12.573607, 12.767739, 12.960042, 13.148767, 13.334643, 13.522610, 13.721753, 13.937655, 14.164423, 14.388871, 14.599890, 14.792248, 14.967972, 15.135880, 15.302904, 15.465254, 15.613231, 15.741710, 15.854465, 15.965900, 16.100673, 16.285130, 16.536533, 16.858001, 17.239365, 17.667584, 18.137162, 18.643280, 19.170522, 19.698013, 20.211348, 20.707996, 21.195428, 21.678423, 22.147147, 22.583679, 22.976640, 23.324222, 23.620907, 23.845084, 23.966536, 23.961501, 23.818455, 23.538501, 23.136600, 22.639646, 22.072859, 21.446952, 20.765168, 20.038713, 19.290224, 18.541615, 17.802311, 17.076663, 16.376543, 15.715687, 15.100270, 14.534163, 14.022527, 13.565671, 13.154743, 12.774570, 12.413013, 12.062815, 11.716556, 11.371306, 11.031555, 10.702433, 10.384675, 10.076334, 9.780631, 9.508289, 9.270781, 9.076295, 8.929607, 8.831945, 8.780910, 8.770332, 8.789930, 8.823589, 8.848079, 8.837820, 8.772304, 8.639049, 8.435042, 8.167614, 7.847951, 7.483830, 7.082590, 6.652673, 6.198220, 5.720260, 5.223833, 4.720884, 4.225147, 3.745833, 3.289561, 2.862170, 2.464169, 2.090378, 1.736162, 1.402588, 1.096101, 0.825487],
    [ 0.000000, 0.391745, 0.329211, 0.257189, 0.176821, 0.089409, -0.003263, -0.097519, -0.188376, -0.272601, -0.349253, -0.417118, -0.473607, -0.515686, -0.541143, -0.549487, -0.540767, -0.514742, -0.472815, -0.418854, -0.358038, -0.296150, -0.238333, -0.187094, -0.142200, -0.102243, -0.066196, -0.034223, -0.006328, 0.019012, 0.044064, 0.071046, 0.102072, 0.138358, 0.178775, 0.220751, 0.263456, 0.308526, 0.358345, 0.415132, 0.480927, 0.557578, 0.646644, 0.749326, 0.866434, 0.997620, 1.140734, 1.293490, 1.454002, 1.618335, 1.780309, 1.933843, 2.074284, 2.198738, 2.307021, 2.402698, 2.491716, 2.579710, 2.670913, 2.768115, 2.872587, 2.984001, 3.099649, 3.213694, 3.319154, 3.411963, 3.493019, 3.565506, 3.631016, 3.690998, 3.750394, 3.816385, 3.894724, 3.987701, 4.094149, 4.211766, 4.337398, 4.464366, 4.583150, 4.684644, 4.761620, 4.809031, 4.824301, 4.808080, 4.764529, 4.698258, 4.610598, 4.500718, 4.368865, 4.217242, 4.049469, 3.870005, 3.683610, 3.495381, 3.310937, 3.134694, 2.967706, 2.809152, 2.659272, 2.518706, 2.386647, 2.261932, 2.143768, 2.030879, 1.922491, 1.818746, 1.719161, 1.622828, 1.529865, 1.441664, 1.360706, 1.290453, 1.234428, 1.195025, 1.173190, 1.168685, 1.180243, 1.205524, 1.240932, 1.282014, 1.324690, 1.365715, 1.401988, 1.429945, 1.445481, 1.444993, 1.426847, 1.391899, 1.343084, 1.284079, 1.217992, 1.147664, 1.076446, 1.007674, 0.943868, 0.886967, 0.839039, 0.802492, 0.779660, 0.772205, 0.780870, 0.805650, 0.846320, 0.903011, 0.976457, 1.067983, 1.179162, 1.311063, 1.463859, 1.637172, 1.830365, 2.042475, 2.272133, 2.517573, 2.776853, 3.048437, 3.331920, 3.627960, 3.936830, 4.257746, 4.589823, 4.931700, 5.279691, 5.626804, 5.963583, 6.281214, 6.574684, 6.842439, 7.082498, 7.289980, 7.459720, 7.590255, 7.685339, 7.753985, 7.808892, 7.862171, 7.922847, 7.998543, 8.095437, 8.216968, 8.365449, 8.541733, 8.743332, 8.965612, 9.201426, 9.439514, 9.667921, 9.879091, 10.071627, 10.250041, 10.422511, 10.595294, 10.767379, 10.928810, 11.063068, 11.153749, 11.191015, 11.171322, 11.090787, 10.941136, 10.714408, 10.409408, 10.033100, 9.597433, 9.112929, 8.584569, 8.014484, 7.406034, 6.764478, 6.096104, 5.407512, 4.705123, 3.994295, 3.277770, 2.555378, 1.826067, 1.089782, 0.347741, -0.397964, -1.144788, -1.890323, -2.632624, -3.369247, -4.096186, -4.809016, -5.505329, -6.185289, -6.848836, -7.492090, -8.105555, -8.675073, -9.186610, -9.631680, -10.009923, -10.330421, -10.610915, -10.871847, -11.129597, -11.393875, -11.669724, -11.965141, -12.296821, -12.685256, -13.146556, -13.689260, -14.313674, -15.010880, -15.764591, -16.556326, -17.364153, -18.157941, -18.904613, -19.577009, -20.156114, -20.629908, -20.992320, -21.242260, -21.382885, -21.421254, -21.368139, -21.237979, -21.049271, -20.825128, -20.593848, -20.386237, -20.225674, -20.120923, -20.072950, -20.082432, -20.143160, -20.234495, -20.327295, -20.393684, -20.410301, -20.358192, -20.222772, -19.994116, -19.667501, -19.243876, -18.730248, -18.139966, -17.492648, -16.811019, -16.111925, -15.400159, -14.673793, -13.932171, -13.177830, -12.415264, -11.649637, -10.885872, -10.128216, -9.379992, -8.643401, -7.919451, -7.208157, -6.509116, -5.822245, -5.148231, -4.488611, -3.845151, -3.218029, -2.604846, -2.002330, -1.408365, -0.822180, -0.243680, 0.327053, 0.889801, 1.443791, 1.987356, 2.518212, 3.034393, 3.535671, 4.024173, 4.502781, 4.972828, 5.432785, 5.878546, 6.306565, 6.716449, 7.108201, 7.478890, 7.824845, 8.145487, 8.444567, 8.728698, 9.002246, 9.263039, 9.504843, 9.722686, 9.913972, 10.073588, 10.189791, 10.247910, 10.236652, 10.150558, 9.990404, 9.763909, 9.484900, 9.167379, 8.819873, 8.448000, 8.060360, 7.669492, 7.286844, 6.918100, 6.565936, 6.234771, 5.928676, 5.648053, 5.392130, 5.160667, 4.951635, 4.759517, 4.576518, 4.396548, 4.216133, 4.032319, 3.844574, 3.656111, 3.471214, 3.293008, 3.123573, 2.966638, 2.828596, 2.715979, 2.633894, 2.586029, 2.574545, 2.599765, 2.659837, 2.750510, 2.864295, 2.989536, 3.112000, 3.218119, 3.296921, 3.341660, 3.351161, 3.327090, 3.270357, 3.182706, 3.067480, 2.926583, 2.760833, 2.573544, 2.371934, 2.164252, 1.956236, 1.751854, 1.554030, 1.362661, 1.175216, 0.990230, 0.809849, 0.639483, 0.485875]]
)

line_true_v = axs.plot(t,true_v.transpose(),'k', label='true velocity')
leg_handles = axs.get_legend().legend_handles
leg_handles.append(line_true_v[0])

axs.legend(handles = leg_handles)
plt.show(block=True)

