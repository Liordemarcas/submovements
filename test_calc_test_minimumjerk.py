import numpy as np

from calculateerrorMJ2D import calculateerrorMJ2D

print('run')
parameters = np.array([1.1029, 0.7147, 18.0366, 4.4470, 0.8562, 0.8599, -14.6265, -8.7907, 1.2370, 0.3035, -7.0312, -3.9655, 1.3205, 0.6167, -16.1851, -7.0697])
# result = np.array([0.114889249313724	,0.999999999997504,	-10.3943584604963,	1.86613481641286,	1.83010741591839,	0.274208099928142,	0.895652387171665,	0.839015899990872,	1.20812922912552,	0.638164414106486,	5.89486007020406,	-7.45597814438603,	1.58876110884474,	0.769417064770060,	7.00038044021369,	1.77255716591134])
result=np.array([1.6303, 0.6804, 7.6581, 2.6730, 0.1670, 0.7110, -7.8019, 1.1488, 0.6091, 0.7611, -4.8086, 3.2461, 1.2085, 0.6418, 6.0304, -7.4907,])
time = np.array([0.0000, 0.0070, 0.0150, 0.0230, 0.0300, 0.0380, 0.0420, 0.0450, 0.0530, 0.0600, 0.0650, 0.0680, 0.0720, 0.0750, 0.0830, 0.0870, 0.0900, 0.0980, 0.1050, 0.1130, 0.1200, 0.1280, 0.1320, 0.1350, 0.1400, 0.1430, 0.1500, 0.1550, 0.1580, 0.1620, 0.1650, 0.1700, 0.1730, 0.1800, 0.1880, 0.1930, 0.1950, 0.2000, 0.2030, 0.2080, 0.2100, 0.2150, 0.2180, 0.2230, 0.2250, 0.2330, 0.2380, 0.2400, 0.2480, 0.2560, 0.2630, 0.2710, 0.2780, 0.2860, 0.2900, 0.2930, 0.2980, 0.3010, 0.3050, 0.3080, 0.3130, 0.3160, 0.3230, 0.3310, 0.3380, 0.3430, 0.3460, 0.3530, 0.3610, 0.3650, 0.3680, 0.3730, 0.3760, 0.3830, 0.3880, 0.3910, 0.3980, 0.4060, 0.4130, 0.4210, 0.4280, 0.4360, 0.4430, 0.4480, 0.4510, 0.4580, 0.4660, 0.4730, 0.4810, 0.4890, 0.4960, 0.5040, 0.5110, 0.5160, 0.5190, 0.5260, 0.5340, 0.5380, 0.5410, 0.5490, 0.5530, 0.5560, 0.5640, 0.5680, 0.5710, 0.5790, 0.5860, 0.5940, 0.6010, 0.6090, 0.6130, 0.6160, 0.6210, 0.6240, 0.6280, 0.6310, 0.6360, 0.6390, 0.6460, 0.6510, 0.6540, 0.6580, 0.6610, 0.6690, 0.6760, 0.6840, 0.6910, 0.6960, 0.6990, 0.7060, 0.7140, 0.7190, 0.7220, 0.7290, 0.7370, 0.7440, 0.7490, 0.7520, 0.7560, 0.7590, 0.7670, 0.7740, 0.7820, 0.7890, 0.7970, 0.8010, 0.8040, 0.8120, 0.8190, 0.8270, 0.8340, 0.8420, 0.8490, 0.8570, 0.8640, 0.8720, 0.8760, 0.8790, 0.8870, 0.8910, 0.8940, 0.8990, 0.9020, 0.9090, 0.9170, 0.9240, 0.9290, 0.9320, 0.9390, 0.9470, 0.9550, 0.9620, 0.9700, 0.9740, 0.9770, 0.9850, 0.9890, 0.9920, 1.0000, 1.0040, 1.0070, 1.0150, 1.0190, 1.0220, 1.0300, 1.0370, 1.0450, 1.0520, 1.0600, 1.0640, 1.0670, 1.0720, 1.0750, 1.0820, 1.0900, 1.0970, 1.1020, 1.1050, 1.1120, 1.1200, 1.1270, 1.1350, 1.1400, 1.1420, 1.1500, 1.1570, 1.1650, 1.1720, 1.1800, 1.1880, 1.1950, 1.2000, 1.2030, 1.2100, 1.2180, 1.2250, 1.2330, 1.2400, 1.2480, 1.2550, 1.2600, 1.2630, 1.2700, 1.2780, 1.2850, 1.2900, 1.2930, 1.2970, 1.3000, 1.3080, 1.3150, 1.3230, 1.3300, 1.3380, 1.3420, 1.3450, 1.3500, 1.3530, 1.3600, 1.3680, 1.3730, 1.3750, 1.3800, 1.3830, 1.3880, 1.3900, 1.3980, 1.4030, 1.4050, 1.4130, 1.4210, 1.4280, 1.4360, 1.4430, 1.4510, 1.4580, 1.4660, 1.4730, 1.4810, 1.4880, 1.4960, 1.5030, 1.5110, 1.5150, 1.5180, 1.5260, 1.5330, 1.5380, 1.5410, 1.5480, 1.5560, 1.5630, 1.5710, 1.5780, 1.5860, 1.5930, 1.6010, 1.6080, 1.6160, 1.6230, 1.6310, 1.6360, 1.6380, 1.6460, 1.6540, 1.6610, 1.6690, 1.6760, 1.6840, 1.6910, 1.6990, 1.7060, 1.7140, 1.7210, 1.7290, 1.7360, 1.7440, 1.7510, 1.7590, 1.7630, 1.7660, 1.7740, 1.7810, 1.7890, 1.7960, 1.8040, 1.8080, 1.8110, 1.8190, 1.8260, 1.8340, 1.8410, 1.8490, 1.8540, 1.8560, 1.8610, 1.8640, 1.8710, 1.8790, 1.8840, 1.8860, 1.8940, 1.9020, 1.9090, 1.9170, 1.9210, 1.9240, 1.9320, 1.9390, 1.9470, 1.9510, 1.9540, 1.9620, 1.9690, 1.9770, 1.9840, 1.9920, 1.9990, 2.0040, 2.0070, 2.0140, 2.0220, 2.0290, 2.0340, 2.0370, 2.0440, 2.0520, 2.0560, 2.0590, 2.0670, 2.0720, 2.0740, 2.0790, 2.0820, 2.0890, 2.0940, 2.0970, 2.1040, 2.1090, 2.1120, 2.1170, 2.1190, 2.1270, 2.1320, 2.1350, 2.1390, 2.1420, 2.1470, 2.1500, 2.1540, 2.1570, 2.1620, 2.1650, 2.1720, 2.1800, 2.1870, 2.1950, 2.2020, 2.2070, 2.2100, 2.2170, 2.2220, 2.2250, 2.2320, 2.2400, 2.2470, 2.2520, 2.2550, 2.2620, 2.2670, 2.2700, 2.2770, 2.2850, 2.2920, 2.2970, 2.3000, 2.3050, 2.3070])
v = np.array([[0.0000, 1.9921, 2.0098, 2.0206, 2.0208, 2.0063, 1.9738, 1.9245, 1.8614, 1.7847, 1.6923, 1.5859, 1.4714, 1.3556, 1.2429, 1.1351, 1.0341, 0.9428, 0.8618, 0.7878, 0.7164, 0.6434, 0.5655, 0.4817, 0.3934, 0.3021, 0.2071, 0.1046, -0.0098, -0.1382, -0.2813, -0.4398, -0.6133, -0.8023, -1.0109, -1.2471, -1.5184, -1.8288, -2.1813, -2.5775, -3.0184, -3.5030, -4.0285, -4.5891, -5.1762, -5.7783, -6.3833, -6.9772, -7.5427, -8.0617, -8.5201, -8.9100, -9.2311, -9.4919, -9.7099, -9.9079, -10.1083, -10.3291, -10.5823, -10.8736, -11.2018, -11.5587, -11.9297, -12.2987, -12.6556, -12.9996, -13.3362, -13.6699, -14.0039, -14.3467, -14.7122, -15.1131, -15.5536, -16.0288, -16.5281, -17.0381, -17.5409, -18.0134, -18.4346, -18.7916, -19.0805, -19.3055, -19.4781, -19.6142, -19.7282, -19.8240, -19.8932, -19.9226, -19.9012, -19.8225, -19.6848, -19.4921, -19.2556, -18.9933, -18.7253, -18.4653, -18.2204, -17.9981, -17.8090, -17.6604, -17.5537, -17.4863, -17.4510, -17.4345, -17.4198, -17.3857, -17.3063, -17.1596, -16.9363, -16.6420, -16.2979, -15.9354, -15.5866, -15.2769, -15.0240, -14.8376, -14.7201, -14.6671, -14.6688, -14.7148, -14.7976, -14.9100, -15.0389, -15.1636, -15.2608, -15.3134, -15.3160, -15.2754, -15.2035, -15.1094, -14.9972, -14.8721, -14.7409, -14.6070, -14.4689, -14.3273, -14.1900, -14.0687, -13.9712, -13.8953, -13.8291, -13.7551, -13.6584, -13.5322, -13.3778, -13.2032, -13.0178, -12.8254, -12.6232, -12.4065, -12.1724, -11.9208, -11.6539, -11.3769, -11.0976, -10.8270, -10.5790, -10.3677, -10.2040, -10.0946, -10.0437, -10.0512, -10.1097, -10.2048, -10.3190, -10.4380, -10.5535, -10.6603, -10.7508, -10.8142, -10.8411, -10.8282, -10.7798, -10.7067, -10.6224, -10.5381, -10.4610, -10.3962, -10.3461, -10.3106, -10.2883, -10.2761, -10.2678, -10.2560, -10.2306, -10.1794, -10.0932, -9.9701, -9.8161, -9.6439, -9.4684, -9.3010, -9.1458, -9.0001, -8.8576, -8.7145, -8.5712, -8.4296, -8.2885, -8.1437, -7.9916, -7.8319, -7.6667, -7.4968, -7.3188, -7.1261, -6.9120, -6.6720, -6.4041, -6.1088, -5.7893, -5.4501, -5.0948, -4.7236, -4.3350, -3.9289, -3.5066, -3.0707, -2.6251, -2.1743, -1.7224, -1.2706, -0.8179, -0.3634, 0.0916, 0.5464, 1.0030, 1.4659, 1.9396, 2.4261, 2.9228, 3.4240, 3.9233, 4.4162, 4.9018, 5.3851, 5.8746, 6.3778, 6.8982, 7.4351, 7.9890, 8.5690, 9.1895, 9.8634, 10.5987, 11.3977, 12.2551, 13.1581, 14.0918, 15.0384, 15.9709, 16.8568, 17.6668, 18.3779, 18.9733, 19.4411, 19.7749, 19.9731, 20.0389, 19.9800, 19.8088, 19.5423, 19.2025, 18.8168, 18.4176, 18.0319, 17.6722, 17.3420, 17.0466, 16.7870, 16.5513, 16.3188, 16.0711, 15.7949, 15.4823, 15.1303, 14.7413, 14.3219, 13.8828, 13.4380, 13.0045, 12.6026, 12.2550, 11.9796, 11.7815, 11.6562, 11.5963, 11.5946, 11.6439, 11.7367, 11.8649, 12.0202, 12.1946, 12.3810, 12.5736, 12.7677, 12.9600, 13.1488, 13.3346, 13.5226, 13.7218, 13.9377, 14.1644, 14.3889, 14.5999, 14.7922, 14.9680, 15.1359, 15.3029, 15.4653, 15.6132, 15.7417, 15.8545, 15.9659, 16.1007, 16.2851, 16.5365, 16.8580, 17.2394, 17.6676, 18.1372, 18.6433, 19.1705, 19.6980, 20.2113, 20.7080, 21.1954, 21.6784, 22.1471, 22.5837, 22.9766, 23.3242, 23.6209, 23.8451, 23.9665, 23.9615, 23.8185, 23.5385, 23.1366, 22.6396, 22.0729, 21.4470, 20.7652, 20.0387, 19.2902, 18.5416, 17.8023, 17.0767, 16.3765, 15.7157, 15.1003, 14.5342, 14.0225, 13.5657, 13.1547, 12.7746, 12.4130, 12.0628, 11.7166, 11.3713, 11.0316, 10.7024, 10.3847, 10.0763, 9.7806, 9.5083, 9.2708, 9.0763, 8.9296, 8.8319, 8.7809, 8.7703, 8.7899, 8.8236, 8.8481, 8.8378, 8.7723, 8.6390, 8.4350, 8.1676, 7.8480, 7.4838, 7.0826, 6.6527, 6.1982, 5.7203, 5.2238, 4.7209, 4.2251, 3.7458, 3.2896, 2.8622, 2.4642, 2.0904, 1.7362, 1.4026, 1.0961, 0.8255],
[0.0000, 0.3917, 0.3292, 0.2572, 0.1768, 0.0894, -0.0033, -0.0975, -0.1884, -0.2726, -0.3493, -0.4171, -0.4736, -0.5157, -0.5411, -0.5495, -0.5408, -0.5147, -0.4728, -0.4189, -0.3580, -0.2961, -0.2383, -0.1871, -0.1422, -0.1022, -0.0662, -0.0342, -0.0063, 0.0190, 0.0441, 0.0710, 0.1021, 0.1384, 0.1788, 0.2208, 0.2635, 0.3085, 0.3583, 0.4151, 0.4809, 0.5576, 0.6466, 0.7493, 0.8664, 0.9976, 1.1407, 1.2935, 1.4540, 1.6183, 1.7803, 1.9338, 2.0743, 2.1987, 2.3070, 2.4027, 2.4917, 2.5797, 2.6709, 2.7681, 2.8726, 2.9840, 3.0996, 3.2137, 3.3192, 3.4120, 3.4930, 3.5655, 3.6310, 3.6910, 3.7504, 3.8164, 3.8947, 3.9877, 4.0941, 4.2118, 4.3374, 4.4644, 4.5832, 4.6846, 4.7616, 4.8090, 4.8243, 4.8081, 4.7645, 4.6983, 4.6106, 4.5007, 4.3689, 4.2172, 4.0495, 3.8700, 3.6836, 3.4954, 3.3109, 3.1347, 2.9677, 2.8092, 2.6593, 2.5187, 2.3866, 2.2619, 2.1438, 2.0309, 1.9225, 1.8187, 1.7192, 1.6228, 1.5299, 1.4417, 1.3607, 1.2905, 1.2344, 1.1950, 1.1732, 1.1687, 1.1802, 1.2055, 1.2409, 1.2820, 1.3247, 1.3657, 1.4020, 1.4299, 1.4455, 1.4450, 1.4268, 1.3919, 1.3431, 1.2841, 1.2180, 1.1477, 1.0764, 1.0077, 0.9439, 0.8870, 0.8390, 0.8025, 0.7797, 0.7722, 0.7809, 0.8057, 0.8463, 0.9030, 0.9765, 1.0680, 1.1792, 1.3111, 1.4639, 1.6372, 1.8304, 2.0425, 2.2721, 2.5176, 2.7769, 3.0484, 3.3319, 3.6280, 3.9368, 4.2577, 4.5898, 4.9317, 5.2797, 5.6268, 5.9636, 6.2812, 6.5747, 6.8424, 7.0825, 7.2900, 7.4597, 7.5903, 7.6853, 7.7540, 7.8089, 7.8622, 7.9228, 7.9985, 8.0954, 8.2170, 8.3654, 8.5417, 8.7433, 8.9656, 9.2014, 9.4395, 9.6679, 9.8791, 10.0716, 10.2500, 10.4225, 10.5953, 10.7674, 10.9288, 11.0631, 11.1537, 11.1910, 11.1713, 11.0908, 10.9411, 10.7144, 10.4094, 10.0331, 9.5974, 9.1129, 8.5846, 8.0145, 7.4060, 6.7645, 6.0961, 5.4075, 4.7051, 3.9943, 3.2778, 2.5554, 1.8261, 1.0898, 0.3477, -0.3980, -1.1448, -1.8903, -2.6326, -3.3692, -4.0962, -4.8090, -5.5053, -6.1853, -6.8488, -7.4921, -8.1056, -8.6751, -9.1866, -9.6317, -10.0099, -10.3304, -10.6109, -10.8718, -11.1296, -11.3939, -11.6697, -11.9651, -12.2968, -12.6853, -13.1466, -13.6893, -14.3137, -15.0109, -15.7646, -16.5563, -17.3642, -18.1579, -18.9046, -19.5770, -20.1561, -20.6299, -20.9923, -21.2423, -21.3829, -21.4213, -21.3681, -21.2380, -21.0493, -20.8251, -20.5938, -20.3862, -20.2257, -20.1209, -20.0730, -20.0824, -20.1432, -20.2345, -20.3273, -20.3937, -20.4103, -20.3582, -20.2228, -19.9941, -19.6675, -19.2439, -18.7302, -18.1400, -17.4926, -16.8110, -16.1119, -15.4002, -14.6738, -13.9322, -13.1778, -12.4153, -11.6496, -10.8859, -10.1282, -9.3800, -8.6434, -7.9195, -7.2082, -6.5091, -5.8222, -5.1482, -4.4886, -3.8452, -3.2180, -2.6048, -2.0023, -1.4084, -0.8222, -0.2437, 0.3271, 0.8898, 1.4438, 1.9874, 2.5182, 3.0344, 3.5357, 4.0242, 4.5028, 4.9728, 5.4328, 5.8785, 6.3066, 6.7164, 7.1082, 7.4789, 7.8248, 8.1455, 8.4446, 8.7287, 9.0022, 9.2630, 9.5048, 9.7227, 9.9140, 10.0736, 10.1898, 10.2479, 10.2367, 10.1506, 9.9904, 9.7639, 9.4849, 9.1674, 8.8199, 8.4480, 8.0604, 7.6695, 7.2868, 6.9181, 6.5659, 6.2348, 5.9287, 5.6481, 5.3921, 5.1607, 4.9516, 4.7595, 4.5765, 4.3965, 4.2161, 4.0323, 3.8446, 3.6561, 3.4712, 3.2930, 3.1236, 2.9666, 2.8286, 2.7160, 2.6339, 2.5860, 2.5745, 2.5998, 2.6598, 2.7505, 2.8643, 2.9895, 3.1120, 3.2181, 3.2969, 3.3417, 3.3512, 3.3271, 3.2704, 3.1827, 3.0675, 2.9266, 2.7608, 2.5735, 2.3719, 2.1643, 1.9562, 1.7519, 1.5540, 1.3627, 1.1752, 0.9902, 0.8098, 0.6395, 0.4859]])
tv = np.array([0.0000, 2.0302, 2.0366, 2.0369, 2.0285, 2.0082, 1.9738, 1.9269, 1.8709, 1.8054, 1.7280, 1.6399, 1.5458, 1.4503, 1.3556, 1.2611, 1.1669, 1.0742, 0.9830, 0.8922, 0.8009, 0.7083, 0.6137, 0.5168, 0.4184, 0.3190, 0.2175, 0.1101, 0.0117, 0.1395, 0.2847, 0.4455, 0.6217, 0.8141, 1.0265, 1.2665, 1.5411, 1.8547, 2.2105, 2.6107, 3.0565, 3.5471, 4.0801, 4.6499, 5.2482, 5.8638, 6.4844, 7.0961, 7.6815, 8.2225, 8.7041, 9.1175, 9.4613, 9.7433, 9.9802, 10.1950, 10.4109, 10.6464, 10.9141, 11.2204, 11.5643, 11.9377, 12.3258, 12.7116, 13.0836, 13.4399, 13.7861, 14.1272, 14.4670, 14.8139, 15.1827, 15.5875, 16.0338, 16.5174, 17.0276, 17.5509, 18.0692, 18.5584, 18.9958, 19.3667, 19.6656, 19.8955, 20.0666, 20.1949, 20.2954, 20.3731, 20.4205, 20.4246, 20.3751, 20.2662, 20.0970, 19.8725, 19.6047, 19.3123, 19.0157, 18.7295, 18.4605, 18.2160, 18.0064, 17.8391, 17.7152, 17.6320, 17.5822, 17.5523, 17.5256, 17.4806, 17.3914, 17.2362, 17.0052, 16.7043, 16.3546, 15.9876, 15.6354, 15.3236, 15.0698, 14.8836, 14.7673, 14.7165, 14.7212, 14.7705, 14.8567, 14.9724, 15.1041, 15.2309, 15.3291, 15.3814, 15.3823, 15.3386, 15.2627, 15.1638, 15.0466, 14.9163, 14.7802, 14.6417, 14.4997, 14.3547, 14.2148, 14.0916, 13.9929, 13.9168, 13.8511, 13.7786, 13.6846, 13.5623, 13.4134, 13.2463, 13.0711, 12.8922, 12.7077, 12.5140, 12.3093, 12.0945, 11.8733, 11.6521, 11.4398, 11.2480, 11.0913, 10.9842, 10.9371, 10.9558, 11.0428, 11.1959, 11.4053, 11.6533, 11.9184, 12.1822, 12.4339, 12.6673, 12.8741, 13.0419, 13.1596, 13.2236, 13.2389, 13.2196, 13.1839, 13.1478, 13.1226, 13.1170, 13.1369, 13.1843, 13.2601, 13.3626, 13.4860, 13.6223, 13.7598, 13.8825, 13.9765, 14.0356, 14.0639, 14.0737, 14.0812, 14.0985, 14.1274, 14.1577, 14.1721, 14.1544, 14.0963, 13.9949, 13.8458, 13.6392, 13.3665, 13.0267, 12.6270, 12.1783, 11.6880, 11.1569, 10.5834, 9.9682, 9.3151, 8.6302, 7.9219, 7.2001, 6.4739, 5.7494, 5.0321, 4.3325, 3.6720, 3.0903, 2.6551, 2.4573, 2.5573, 2.9232, 3.4671, 4.1123, 4.8099, 5.5324, 6.2661, 7.0040, 7.7391, 8.4608, 9.1542, 9.8040, 10.4001, 10.9408, 11.4344, 11.8992, 12.3575, 12.8275, 13.3194, 13.8370, 14.3871, 14.9880, 15.6640, 16.4353, 17.3126, 18.2972, 19.3782, 20.5343, 21.7415, 22.9710, 24.1822, 25.3285, 26.3699, 27.2767, 28.0282, 28.6118, 29.0221, 29.2601, 29.3330, 29.2540, 29.0420, 28.7224, 28.3270, 27.8959, 27.4737, 27.0967, 26.7798, 26.5268, 26.3418, 26.2212, 26.1415, 26.0673, 25.9650, 25.8081, 25.5765, 25.2564, 24.8409, 24.3296, 23.7289, 23.0522, 22.3199, 21.5597, 20.8038, 20.0775, 19.3899, 18.7400, 18.1268, 17.5525, 17.0212, 16.5368, 16.1021, 15.7183, 15.3848, 15.0996, 14.8598, 14.6619, 14.5028, 14.3801, 14.2939, 14.2481, 14.2503, 14.3043, 14.4019, 14.5275, 14.6677, 14.8151, 14.9700, 15.1394, 15.3288, 15.5325, 15.7392, 15.9419, 16.1422, 16.3527, 16.5960, 16.8962, 17.2681, 17.7118, 18.2141, 18.7594, 19.3408, 19.9524, 20.5777, 21.1953, 21.7910, 22.3636, 22.9224, 23.4733, 24.0062, 24.5023, 24.9491, 25.3438, 25.6793, 25.9311, 26.0656, 26.0565, 25.8912, 25.5709, 25.1125, 24.5462, 23.9009, 23.1897, 22.4179, 21.5991, 20.7589, 19.9221, 19.0993, 18.2955, 17.5232, 16.7968, 16.1220, 15.5022, 14.9420, 14.4411, 13.9893, 13.5696, 13.1686, 12.7784, 12.3910, 12.0036, 11.6216, 11.2513, 10.8943, 10.5494, 10.2206, 9.9201, 9.6604, 9.4507, 9.2965, 9.1995, 9.1577, 9.1648, 9.2102, 9.2768, 9.3395, 9.3697, 9.3440, 9.2468, 9.0729, 8.8284, 8.5241, 8.1672, 7.7648, 7.3258, 6.8544, 6.3517, 5.8234, 5.2833, 4.7472, 4.2259, 3.7270, 3.2568, 2.8158, 2.3981, 1.9987, 1.6196, 1.2690, 0.9579])
epsilon =0.0225649494521437
a = calculateerrorMJ2D(result,time,v,tv,0.005)
print(a)

print('epsilon',epsilon)
print('finished')